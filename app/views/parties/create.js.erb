console.log('test');
$('.btn-booking-confirm').hide();

<%# if @party.errors.any? %>
  // Render new review form with errors
<%# else %>

<%# end %>


var handler = StripeCheckout.configure({
  key: "<%= j Rails.configuration.stripe[:publishable_key] %>",
  image: 'https://stripe.com/img/documentation/checkout/marketplace.png',
  locale: 'auto',
  name: "Superbarman",
  description: "<%= j "#{@party.theme} - #{@party.date}"%>",
  amount: <%= @party.price_cents %>,
  currency: "<%= j @party.price.currency.to_s %>",
  email: "<%= j current_user.email %>",
  token: function(token) {
    console.log(token);
    $.post( "<%= j party_payments_path(@party) %>", { token: token }, function(){
      window.location.href = "<%= j party_path(@party) %>"
    });
  }
});

handler.open();


<% if false %>


  // Generate the btn. But hide it.
    // var btn_payment_html = $("<%= j render 'reviews/show', party: @party %>").hide();
  // Add it to the DOM, at the end of the existing reviews. It's still hidden.
    // $('#home-form-show').append(btn_payment_html);
  // Show the btn with an animation!
    // btn_payment_html.slideDown();
  // Reset the form
    // $('#home-form-show').html("<%= j render 'new_form', party: @party %>");

<% end %>
